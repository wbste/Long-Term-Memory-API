0000	2d 2d 20 43 72 65 61 74  65 54 61 62 6c 65 0a 43   -- CreateTable.C
0010	52 45 41 54 45 20 54 41  42 4c 45 20 22 53 65 73   REATE TABLE "Ses
0020	73 69 6f 6e 22 20 28 0a  20 20 20 20 22 69 64 22   sion" (.    "id"
0030	20 54 45 58 54 20 4e 4f  54 20 4e 55 4c 4c 2c 0a    TEXT NOT NULL,.
0040	20 20 20 20 22 65 78 74  65 72 6e 61 6c 49 64 22       "externalId"
0050	20 54 45 58 54 2c 0a 20  20 20 20 22 63 72 65 61    TEXT,.    "crea
0060	74 65 64 41 74 22 20 54  49 4d 45 53 54 41 4d 50   tedAt" TIMESTAMP
0070	28 33 29 20 4e 4f 54 20  4e 55 4c 4c 20 44 45 46   (3) NOT NULL DEF
0080	41 55 4c 54 20 43 55 52  52 45 4e 54 5f 54 49 4d   AULT CURRENT_TIM
0090	45 53 54 41 4d 50 2c 0a  20 20 20 20 22 75 70 64   ESTAMP,.    "upd
00a0	61 74 65 64 41 74 22 20  54 49 4d 45 53 54 41 4d   atedAt" TIMESTAM
00b0	50 28 33 29 20 4e 4f 54  20 4e 55 4c 4c 2c 0a 20   P(3) NOT NULL,. 
00c0	20 20 20 43 4f 4e 53 54  52 41 49 4e 54 20 22 53      CONSTRAINT "S
00d0	65 73 73 69 6f 6e 5f 70  6b 65 79 22 20 50 52 49   ession_pkey" PRI
00e0	4d 41 52 59 20 4b 45 59  20 28 22 69 64 22 29 0a   MARY KEY ("id").
00f0	29 3b 0a 0a 2d 2d 20 43  72 65 61 74 65 54 61 62   );..-- CreateTab
0100	6c 65 0a 43 52 45 41 54  45 20 54 41 42 4c 45 20   le.CREATE TABLE 
0110	22 4d 65 6d 6f 72 79 22  20 28 0a 20 20 20 20 22   "Memory" (.    "
0120	69 64 22 20 54 45 58 54  20 4e 4f 54 20 4e 55 4c   id" TEXT NOT NUL
0130	4c 2c 0a 20 20 20 20 22  73 65 73 73 69 6f 6e 49   L,.    "sessionI
0140	64 22 20 54 45 58 54 20  4e 4f 54 20 4e 55 4c 4c   d" TEXT NOT NULL
0150	2c 0a 20 20 20 20 22 74  65 78 74 22 20 54 45 58   ,.    "text" TEX
0160	54 20 4e 4f 54 20 4e 55  4c 4c 2c 0a 20 20 20 20   T NOT NULL,.    
0170	22 63 6f 6d 70 72 65 73  73 65 64 54 65 78 74 22   "compressedText"
0180	20 54 45 58 54 20 4e 4f  54 20 4e 55 4c 4c 2c 0a    TEXT NOT NULL,.
0190	20 20 20 20 22 6d 65 74  61 64 61 74 61 22 20 4a       "metadata" J
01a0	53 4f 4e 42 2c 0a 20 20  20 20 22 69 6d 70 6f 72   SONB,.    "impor
01b0	74 61 6e 63 65 53 63 6f  72 65 22 20 44 4f 55 42   tanceScore" DOUB
01c0	4c 45 20 50 52 45 43 49  53 49 4f 4e 20 4e 4f 54   LE PRECISION NOT
01d0	20 4e 55 4c 4c 2c 0a 20  20 20 20 22 72 65 63 65    NULL,.    "rece
01e0	6e 63 79 53 63 6f 72 65  22 20 44 4f 55 42 4c 45   ncyScore" DOUBLE
01f0	20 50 52 45 43 49 53 49  4f 4e 2c 0a 20 20 20 20    PRECISION,.    
0200	22 65 6d 62 65 64 64 69  6e 67 22 20 44 4f 55 42   "embedding" DOUB
0210	4c 45 20 50 52 45 43 49  53 49 4f 4e 5b 5d 20 44   LE PRECISION[] D
0220	45 46 41 55 4c 54 20 41  52 52 41 59 5b 5d 3a 3a   EFAULT ARRAY[]::
0230	44 4f 55 42 4c 45 20 50  52 45 43 49 53 49 4f 4e   DOUBLE PRECISION
0240	5b 5d 2c 0a 20 20 20 20  22 63 72 65 61 74 65 64   [],.    "created
0250	41 74 22 20 54 49 4d 45  53 54 41 4d 50 28 33 29   At" TIMESTAMP(3)
0260	20 4e 4f 54 20 4e 55 4c  4c 20 44 45 46 41 55 4c    NOT NULL DEFAUL
0270	54 20 43 55 52 52 45 4e  54 5f 54 49 4d 45 53 54   T CURRENT_TIMEST
0280	41 4d 50 2c 0a 20 20 20  20 22 6c 61 73 74 41 63   AMP,.    "lastAc
0290	63 65 73 73 65 64 41 74  22 20 54 49 4d 45 53 54   cessedAt" TIMEST
02a0	41 4d 50 28 33 29 20 4e  4f 54 20 4e 55 4c 4c 20   AMP(3) NOT NULL 
02b0	44 45 46 41 55 4c 54 20  43 55 52 52 45 4e 54 5f   DEFAULT CURRENT_
02c0	54 49 4d 45 53 54 41 4d  50 2c 0a 20 20 20 20 22   TIMESTAMP,.    "
02d0	69 73 44 65 6c 65 74 65  64 22 20 42 4f 4f 4c 45   isDeleted" BOOLE
02e0	41 4e 20 4e 4f 54 20 4e  55 4c 4c 20 44 45 46 41   AN NOT NULL DEFA
02f0	55 4c 54 20 66 61 6c 73  65 2c 0a 20 20 20 20 43   ULT false,.    C
0300	4f 4e 53 54 52 41 49 4e  54 20 22 4d 65 6d 6f 72   ONSTRAINT "Memor
0310	79 5f 70 6b 65 79 22 20  50 52 49 4d 41 52 59 20   y_pkey" PRIMARY 
0320	4b 45 59 20 28 22 69 64  22 29 0a 29 3b 0a 0a 2d   KEY ("id").);..-
0330	2d 20 43 72 65 61 74 65  49 6e 64 65 78 0a 43 52   - CreateIndex.CR
0340	45 41 54 45 20 55 4e 49  51 55 45 20 49 4e 44 45   EATE UNIQUE INDE
0350	58 20 22 53 65 73 73 69  6f 6e 5f 65 78 74 65 72   X "Session_exter
0360	6e 61 6c 49 64 5f 6b 65  79 22 20 4f 4e 20 22 53   nalId_key" ON "S
0370	65 73 73 69 6f 6e 22 28  22 65 78 74 65 72 6e 61   ession"("externa
0380	6c 49 64 22 29 3b 0a 0a  2d 2d 20 43 72 65 61 74   lId");..-- Creat
0390	65 49 6e 64 65 78 0a 43  52 45 41 54 45 20 49 4e   eIndex.CREATE IN
03a0	44 45 58 20 22 4d 65 6d  6f 72 79 5f 73 65 73 73   DEX "Memory_sess
03b0	69 6f 6e 49 64 5f 63 72  65 61 74 65 64 41 74 5f   ionId_createdAt_
03c0	69 64 78 22 20 4f 4e 20  22 4d 65 6d 6f 72 79 22   idx" ON "Memory"
03d0	28 22 73 65 73 73 69 6f  6e 49 64 22 2c 20 22 63   ("sessionId", "c
03e0	72 65 61 74 65 64 41 74  22 29 3b 0a 0a 2d 2d 20   reatedAt");..-- 
03f0	43 72 65 61 74 65 49 6e  64 65 78 0a 43 52 45 41   CreateIndex.CREA
0400	54 45 20 49 4e 44 45 58  20 22 4d 65 6d 6f 72 79   TE INDEX "Memory
0410	5f 73 65 73 73 69 6f 6e  49 64 5f 69 6d 70 6f 72   _sessionId_impor
0420	74 61 6e 63 65 53 63 6f  72 65 5f 69 64 78 22 20   tanceScore_idx" 
0430	4f 4e 20 22 4d 65 6d 6f  72 79 22 28 22 73 65 73   ON "Memory"("ses
0440	73 69 6f 6e 49 64 22 2c  20 22 69 6d 70 6f 72 74   sionId", "import
0450	61 6e 63 65 53 63 6f 72  65 22 29 3b 0a 0a 2d 2d   anceScore");..--
0460	20 43 72 65 61 74 65 49  6e 64 65 78 0a 43 52 45    CreateIndex.CRE
0470	41 54 45 20 49 4e 44 45  58 20 22 4d 65 6d 6f 72   ATE INDEX "Memor
0480	79 5f 73 65 73 73 69 6f  6e 49 64 5f 69 73 44 65   y_sessionId_isDe
0490	6c 65 74 65 64 5f 69 64  78 22 20 4f 4e 20 22 4d   leted_idx" ON "M
04a0	65 6d 6f 72 79 22 28 22  73 65 73 73 69 6f 6e 49   emory"("sessionI
04b0	64 22 2c 20 22 69 73 44  65 6c 65 74 65 64 22 29   d", "isDeleted")
04c0	3b 0a 0a 2d 2d 20 41 64  64 46 6f 72 65 69 67 6e   ;..-- AddForeign
04d0	4b 65 79 0a 41 4c 54 45  52 20 54 41 42 4c 45 20   Key.ALTER TABLE 
04e0	22 4d 65 6d 6f 72 79 22  20 41 44 44 20 43 4f 4e   "Memory" ADD CON
04f0	53 54 52 41 49 4e 54 20  22 4d 65 6d 6f 72 79 5f   STRAINT "Memory_
0500	73 65 73 73 69 6f 6e 49  64 5f 66 6b 65 79 22 20   sessionId_fkey" 
0510	46 4f 52 45 49 47 4e 20  4b 45 59 20 28 22 73 65   FOREIGN KEY ("se
0520	73 73 69 6f 6e 49 64 22  29 20 52 45 46 45 52 45   ssionId") REFERE
0530	4e 43 45 53 20 22 53 65  73 73 69 6f 6e 22 28 22   NCES "Session"("
0540	69 64 22 29 20 4f 4e 20  44 45 4c 45 54 45 20 43   id") ON DELETE C
0550	41 53 43 41 44 45 20 4f  4e 20 55 50 44 41 54 45   ASCADE ON UPDATE
0560	20 43 41 53 43 41 44 45  3b 0d 0a                   CASCADE;..
